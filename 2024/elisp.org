#+title: Elisp AoC tryouts

* Day 1
https://adventofcode.com/2024/day/1

#+name: example-1a
#+begin_example
3   4
4   3
2   5
1   3
3   9
3   3
#+end_example

#+name: input-file
#+begin_src elisp :var fname=""
(f-read fname)
#+end_src


#+name: process-input
#+begin_src elisp :var input=example-1a()
(mapcar (lambda (e) (mapcar #'string-to-number (s-split "\s+" e))) (s-lines (s-trim input)))
#+end_src

#+RESULTS: process-input
| 3 | 4 |
| 4 | 3 |
| 2 | 5 |
| 1 | 3 |
| 3 | 9 |
| 3 | 3 |

#+name: calculate-1a
#+begin_src elisp :var input=process-input()
(let ((left (sort (mapcar #'car input) #'<))
      (right (sort (mapcar (lambda (l) (cadr l)) input) #'<))
      (difference 0))
  (cl-loop for l in left for r in right collect (setq difference (+ difference (abs (- l r)))))
  difference)
#+end_src

#+RESULTS: calculate-1a
: 11

#+call: calculate-1a(process-input(input-file("input-1.txt")))

#+name: calculate-1b
#+begin_src elisp :var input=process-input()
(let ((left (sort (mapcar #'car input) #'<))
      (right (sort (mapcar (lambda (l) (cadr l)) input) #'<))
      (total 0))
  (cl-loop for l in left collect (setq total (+ total (* l (count l right)))))
  total)
#+end_src

#+RESULTS:
: 31

#+call: calculate-1b(process-input(input-file("input-1.txt")))

* Day 2

#+name: example-2a
#+begin_example
7 6 4 2 1
1 2 7 8 9
9 7 6 2 1
1 3 2 4 5
8 6 4 4 1
1 3 6 7 9
#+end_example

#+name: calculate-2a
#+begin_src elisp :var input=process-input(example-2a)
(defun safe (level)
  "checks if a level is safe aka only increasing, only decreasing and by 1, 2 or 3"
  (let ((diff (mapcar (lambda (l) (- (car l) (cdr l)))
                      (cl-pairlis level (cdr level)))))
    (or (cl-every (lambda (l) (and (< l 0)
                                   (> l -4))) diff)
        (cl-every (lambda (l) (and (> l 0)
                                   (< l 4))) diff))))
(cl-count t (mapcar #'safe input))
#+end_src

#+RESULTS:
: 2

#+call: calculate-2a(process-input(input-file("input-2.txt")))


#+name: calculate-2b
#+begin_src elisp :var input=process-input(example-2a)
(defun safe (level)
  "checks if a level is safe aka only increasing, only decreasing and by 1, 2 or 3"
  (let ((diff (mapcar (lambda (l) (- (car l) (cdr l)))
                      (cl-pairlis level (cdr level)))))
    (or (cl-every (lambda (l) (and (< l 0)
                                   (> l -4))) diff)
        (cl-every (lambda (l) (and (> l 0)
                                   (< l 4))) diff))))
(defun safe-modified (level)
  "checks if a level is safe aka only increasing, only decreasing and by 1, 2 or 3"
  (let ((sublevels (cons level (cl-mapcar (lambda (x i) (append (cl-subseq level 0 i) (cl-subseq level (1+ i)))) level (number-sequence 0 (length level))))))
    (cl-count t (mapcar 'safe sublevels))))

(cl-count-if (lambda (x) (> x 0)) (mapcar #'safe-modified input))
#+end_src

#+RESULTS: calculate-2b
: 4

#+call: calculate-2b(process-input(input-file("input-2.txt")))

* Day 3
#+name: example-3a
#+begin_example
xmul(2,4)%&mul[3,7]!@^do_not_mul(5,5)+mul(32,64]then(mul(11,8)mul(8,5))
#+end_example

#+name: extract-3a
#+begin_src elisp :var input=example-3a
(cl-reduce #'+ (mapcar (lambda (m) (cl-reduce #'* (mapcar #'string-to-number (cdr m))))
                       (s-match-strings-all (rx "mul(" (group (** 1 3 num)) "," (group (** 1 3 num)) ")") input)))
#+end_src

#+RESULTS: extract-3a
: 161

#+call: extract-3a(input-file("input-3.txt"))

#+RESULTS:
: 182780583

#+name: example-3b
#+begin_example
xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))
#+end_example

#+name: extract-3b
#+begin_src elisp :var input=example-3b
(cl-reduce #'+ (let* ((mult 1))
                 (mapcar (lambda (m) (cond ((s-equals? (cadr m) "mul") (* mult (string-to-number (caddr m)) (string-to-number (cadddr m))))
                                           ((s-equals? (cadr m) "do") (setq mult 1) 0)
                                           ((s-equals? (cadr m) "don't") (setq mult 0) 0)))
                         (s-match-strings-all (rx (or (: (group-n 1 "mul") "(" (group (** 1 3 num)) "," (group (** 1 3 num)) ")")
                                                      (: (group-n 1 "do") "()")
                                                      (: (group-n 1 "don't") "()"))) input))))
#+end_src

#+RESULTS: extract-3b
: 48

#+call: extract-3b(input-file("input-3.txt"))

#+RESULTS:
: 90772405
